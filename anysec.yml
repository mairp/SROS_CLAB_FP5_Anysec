name: anysec
prefix: ""

mgmt:
  network: anysec
  ipv4_subnet: 172.10.10.0/24

topology:
  kinds:
    vr-sros:
      image: vrnetlab/vr-sros:23.7.R1
      license: /opt/nokia/sros/r23_license.key

  nodes:
    SR-1x-92S:
      kind: vr-sros
      mgmt_ipv4: 172.10.10.11
      type: >-
        cp: cpu=2 ram=4 chassis=sr-1x-92s slot=A card=cpm-1x/i80-200g-sfpdd+12-800g-qsfpdd-1x ___ 
        lc: cpu=2 ram=4 max_nics=10 chassis=sr-1x-92s slot=1 card=i80-200g-sfpdd+12-800g-qsfpdd-1x mda/1=m80-200g-sfpdd+12-800g-qsfpdd-1x
      startup-config: configs/core/sr-1x-92s.partial.cfg

    SR-1se:
      kind: vr-sros
      mgmt_ipv4: 172.10.10.12
      type: >-
        cp: cpu=4 ram=6 chassis=SR-1se slot=A card=cpm-1se ___ 
        lc: cpu=4 ram=6 max_nics=10 chassis=SR-1se slot=1 card=imm36-800g-qsfpdd mda/1=ms36-800g-qsfpdd
      startup-config: configs/core/sr-1se.partial.cfg
    
    SR-2se:
      kind: vr-sros
      mgmt_ipv4: 172.10.10.13
      type: >-
        cp: cpu=2 min_ram=4 chassis=sr-2se slot=A sfm=sfm-2se card=cpm-2se ___
        lc: cpu=4 min_ram=8 max_nics=10 chassis=sr-2se slot=1 sfm=sfm-2se card=xcm-2se mda/1=x2-s36-800g-qsfpdd-18.0t
      startup-config: configs/core/sr-2se.partial.cfg
      
    SR-7s:
      kind: vr-sros
      mgmt_ipv4: 172.10.10.14
      type: >-
        cp: cpu=4 ram=6 chassis=sr-7s slot=A sfm=sfm2-s card=cpm2-s ___ 
        lc: cpu=4 ram=8 max_nics=10 chassis=sr-7s slot=1 sfm=sfm2-s card=xcm2-7s mda/1=x2-s36-800g-qsfpdd-18.0t
      startup-config: configs/core/sr-7s.partial.cfg



    ### TELEMETRY STACK ###
    gnmic:
      kind: linux
      mgmt_ipv4: 172.10.10.21
      image: ghcr.io/openconfig/gnmic:0.29.0
      binds:
        - configs/gnmic/gnmic-config.yml:/gnmic-config.yml:ro
      cmd: --config /gnmic-config.yml --log subscribe
      group: "10" # group 10 is assigned to the nodes of a telemetry stack

    prometheus:
      kind: linux
      mgmt_ipv4: 172.10.10.22
      image: prom/prometheus:v2.35.0
      binds:
        - configs/prometheus/prometheus.yml:/etc/prometheus/prometheus.yml:ro
      cmd: --config.file=/etc/prometheus/prometheus.yml
      ports:
        - 9090:9090
      group: "10"

    grafana:
      kind: linux
      mgmt_ipv4: 172.10.10.23
      image: grafana/grafana:9.5.2
      binds:
        - configs/grafana/datasource.yml:/etc/grafana/provisioning/datasources/datasource.yaml:ro
        - configs/grafana/dashboards.yml:/etc/grafana/provisioning/dashboards/dashboards.yaml:ro
        - configs/grafana/dashboards:/var/lib/grafana/dashboards
      ports:
        - 3000:3000
      env:
        GF_INSTALL_PLUGINS: https://algenty.github.io/flowcharting-repository/archives/agenty-flowcharting-panel-1.0.0d.220606199-SNAPSHOT.zip;agenty-flowcharting-panel    
      group: "10"




  links:
    - endpoints: ["SR-1x-92S:eth1", "SR-1se:eth1"]
    - endpoints: ["SR-1se:eth2", "SR-2se:eth2"]
    - endpoints: ["SR-2se:eth3", "SR-7s:eth3"]
    - endpoints: ["SR-1x-92S:eth4", "SR-7s:eth4"]
    - endpoints: ["SR-1x-92S:eth8", "SR-1x-92S:eth9"]
    - endpoints: ["SR-1se:eth8", "SR-1se:eth9"]
    - endpoints: ["SR-2se:eth8", "SR-2se:eth9"]
    - endpoints: ["SR-7s:eth8", "SR-7s:eth9"]